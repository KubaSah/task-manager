{% extends 'base.html' %}

{% block title %}Wyszukiwanie — {{ q or '' }}{% endblock %}
{% block section_title %}Wyniki wyszukiwania{% endblock %}

{% block content %}
<div class="card search-card">
    <div class="card-body">
        <form action="{{ url_for('core.search') }}" method="get" class="filter-bar">
            <input type="search" name="q" class="filter-input search-input" value="{{ q or '' }}"
                placeholder="Szukaj w projektach i zadaniach…" />
            <button class="btn btn-primary" type="submit">Szukaj</button>
        </form>
    </div>
</div>

{% if not q %}
<p class="search-prompt">Wpisz frazę, aby rozpocząć wyszukiwanie.</p>
{% else %}
<div class="grid search-results">
    <div>
        <h3>Projekty</h3>
        {% if projects %}
        <ul class="list">
            {% for p in projects %}
            <li><a href="{{ url_for('projects.project_detail', project_id=p.id) }}"><strong>{{ p.key }}</strong> — {{
                    p.name }}</a></li>
            {% endfor %}
        </ul>
        {% else %}
        <p class="muted">Brak wyników w projektach.</p>
        {% endif %}
    </div>
    <div>
        <h3>Zadania</h3>
        {% if tasks %}
        <ul class="list">
            {% for t in tasks %}
            <li>
                <a href="{{ url_for('tasks.task_detail', task_id=t.id) }}">#{{ t.id }} — {{ t.title }}</a>
                <small class="muted">[{{ t.status }} | {{ t.priority }} | {{ t.project.key if t.project else '—'
                    }}]</small>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p class="muted">Brak wyników w zadaniach.</p>
        {% endif %}
    </div>
</div>
{% endif %}
{% endblock %}